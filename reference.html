<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>React Internals — A Deep Dive</title>
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400&family=JetBrains+Mono:ital,wght@0,400;0,500;0,600;1,400&family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #FAFAF8;
    --fg: #1A1A18;
    --fg-muted: #555550;
    --fg-faint: #8A8A82;
    --accent: #B5493A;
    --accent-dim: #B5493A18;
    --code-bg: #F0EFEB;
    --code-border: #E2E1DC;
    --border: #E0DFDA;
    --body: 'Atkinson Hyperlegible', system-ui, sans-serif;
    --sans: 'Source Sans 3', 'Atkinson Hyperlegible', system-ui, sans-serif;
    --mono: 'JetBrains Mono', 'Cascadia Code', monospace;
    --max-w: 740px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  html { 
    font-size: 18px; 
    scroll-behavior: smooth;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  body {
    font-family: var(--body);
    color: var(--fg);
    background: var(--bg);
    line-height: 1.78;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }

  ::selection {
    background: var(--accent-dim);
    color: var(--accent);
  }

  /* — Header — */
  header {
    max-width: var(--max-w);
    margin: 0 auto;
    padding: 6rem 2rem 3rem;
    border-bottom: 1px solid var(--border);
  }

  header .eyebrow {
    font-family: var(--mono);
    font-size: 0.7rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent);
    font-weight: 500;
    margin-bottom: 1.2rem;
  }

  header h1 {
    font-family: var(--body);
    font-weight: 700;
    font-size: 2.6rem;
    line-height: 1.18;
    letter-spacing: -0.02em;
    margin-bottom: 1rem;
  }

  header .subtitle {
    font-family: var(--sans);
    font-size: 0.92rem;
    color: var(--fg-muted);
    line-height: 1.6;
    max-width: 540px;
  }

  /* — Table of Contents — */
  nav.toc {
    max-width: var(--max-w);
    margin: 0 auto;
    padding: 2.5rem 2rem;
    border-bottom: 1px solid var(--border);
  }

  nav.toc .toc-label {
    font-family: var(--mono);
    font-size: 0.65rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--fg-faint);
    margin-bottom: 1rem;
    font-weight: 500;
  }

  nav.toc ol {
    list-style: none;
    columns: 2;
    column-gap: 2rem;
  }

  nav.toc li {
    break-inside: avoid;
    margin-bottom: 0.35rem;
  }

  nav.toc a {
    font-family: var(--sans);
    font-size: 0.82rem;
    color: var(--fg-muted);
    text-decoration: none;
    transition: color 0.2s;
    display: inline-flex;
    align-items: baseline;
    gap: 0.5rem;
  }

  nav.toc a:hover { color: var(--accent); }

  nav.toc a .num {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--fg-faint);
    min-width: 1.4rem;
  }

  /* — Main Content — */
  main {
    max-width: var(--max-w);
    margin: 0 auto;
    padding: 0 2rem 6rem;
  }

  /* — Sections — */
  section {
    padding-top: 3.5rem;
    opacity: 0;
    transform: translateY(12px);
    animation: fadeUp 0.5s ease forwards;
  }

  section:nth-child(1) { animation-delay: 0.05s; }
  section:nth-child(2) { animation-delay: 0.08s; }
  section:nth-child(3) { animation-delay: 0.11s; }

  @keyframes fadeUp {
    to { opacity: 1; transform: translateY(0); }
  }

  section h2 {
    font-family: var(--body);
    font-weight: 700;
    font-size: 1.5rem;
    letter-spacing: -0.01em;
    margin-bottom: 0.3rem;
    line-height: 1.3;
    display: flex;
    align-items: baseline;
    gap: 0.6rem;
  }

  section h2 .section-num {
    font-family: var(--mono);
    font-size: 0.72rem;
    color: var(--accent);
    font-weight: 500;
    flex-shrink: 0;
    position: relative;
    top: -0.1em;
  }

  section h2::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
    margin-left: 0.8rem;
    position: relative;
    top: -0.2em;
  }

  section h3 {
    font-family: var(--sans);
    font-weight: 600;
    font-size: 0.95rem;
    margin-top: 2.2rem;
    margin-bottom: 0.6rem;
    letter-spacing: -0.01em;
    color: var(--fg);
  }

  section h4 {
    font-family: var(--mono);
    font-weight: 500;
    font-size: 0.78rem;
    margin-top: 1.8rem;
    margin-bottom: 0.5rem;
    letter-spacing: 0.02em;
    color: var(--fg-muted);
  }

  p {
    margin-bottom: 1rem;
  }

  strong {
    font-weight: 500;
    color: var(--fg);
  }

  em { font-style: italic; }

  a {
    color: var(--accent);
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
    transition: opacity 0.2s;
  }
  a:hover { opacity: 0.7; }

  /* — Code — */
  code {
    font-family: var(--mono);
    font-size: 0.84em;
    background: var(--code-bg);
    border: 1px solid var(--code-border);
    border-radius: 4px;
    padding: 0.12em 0.4em;
  }

  pre {
    background: #F7F6F3;
    color: #3B3B37;
    border-radius: 6px;
    padding: 1.2rem 1.4rem;
    overflow-x: auto;
    margin: 1rem 0 1.2rem;
    font-size: 0.78rem;
    line-height: 1.75;
    border: 1px solid #E2E1DC;
    position: relative;
  }

  pre code {
    background: none;
    border: none;
    padding: 0;
    font-size: inherit;
    color: inherit;
  }

  pre .label {
    position: absolute;
    top: 0.6rem;
    right: 0.8rem;
    font-family: var(--mono);
    font-size: 0.6rem;
    color: #B0AFA8;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    pointer-events: none;
  }

  /* Syntax — Soft Slate theme (light background, high contrast, low saturation) */
  .kw { color: #8B5CF6; }
  .str { color: #16803C; }
  .cm { color: #9E9E90; font-style: italic; }
  .fn { color: #C2590A; }
  .num { color: #1D71B8; }
  .prop { color: #B5493A; }
  .type { color: #7C3AED; }
  .op { color: #7A7A70; }

  /* — Callout boxes — */
  .callout {
    border-left: 3px solid var(--accent);
    padding: 0.9rem 1.2rem;
    margin: 1.2rem 0;
    background: var(--accent-dim);
    border-radius: 0 4px 4px 0;
    font-size: 0.9rem;
  }

  .callout p:last-child { margin-bottom: 0; }

  .callout.neutral {
    border-left-color: var(--border);
    background: var(--code-bg);
  }

  /* — Diagram blocks — */
  .diagram {
    background: #F7F6F3;
    color: #5A5A52;
    border-radius: 6px;
    padding: 1.4rem 1.6rem;
    overflow-x: auto;
    margin: 1.2rem 0 1.4rem;
    font-family: var(--mono);
    font-size: 0.72rem;
    line-height: 1.7;
    white-space: pre;
    border: 1px solid #E2E1DC;
  }

  .diagram .hl { color: #8B5CF6; font-weight: 500; }
  .diagram .hl2 { color: #16803C; }
  .diagram .hl3 { color: #C2590A; }
  .diagram .dim { color: #B0AFA8; }

  /* — Misconception blocks — */
  .misconception {
    padding: 1rem 0;
    border-bottom: 1px solid var(--border);
  }

  .misconception:last-child { border-bottom: none; }

  .misconception .myth {
    font-family: var(--sans);
    font-weight: 600;
    font-size: 0.88rem;
    color: var(--fg);
    margin-bottom: 0.3rem;
  }

  .misconception .reality {
    font-size: 0.92rem;
    color: var(--fg-muted);
  }

  /* — Resource list — */
  .resources {
    list-style: none;
    margin: 0.8rem 0 1.2rem;
  }

  .resources li {
    padding: 0.6rem 0;
    border-bottom: 1px solid var(--border);
    font-size: 0.88rem;
  }

  .resources li:last-child { border-bottom: none; }

  .resources .res-title {
    font-family: var(--sans);
    font-weight: 500;
    font-size: 0.88rem;
  }

  .resources .res-desc {
    color: var(--fg-muted);
    font-size: 0.82rem;
    margin-top: 0.15rem;
  }

  /* — File reference table — */
  .file-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0 1.4rem;
    font-size: 0.82rem;
  }

  .file-table th {
    font-family: var(--sans);
    font-weight: 600;
    font-size: 0.72rem;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    text-align: left;
    padding: 0.5rem 0.8rem;
    border-bottom: 2px solid var(--border);
    color: var(--fg-muted);
  }

  .file-table td {
    padding: 0.55rem 0.8rem;
    border-bottom: 1px solid var(--border);
    vertical-align: top;
  }

  .file-table td:first-child {
    font-family: var(--mono);
    font-size: 0.78rem;
    color: var(--accent);
    white-space: nowrap;
  }

  .file-table td:last-child {
    color: var(--fg-muted);
  }

  /* — Footer — */
  footer {
    max-width: var(--max-w);
    margin: 0 auto;
    padding: 2rem 2rem 4rem;
    border-top: 1px solid var(--border);
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--fg-faint);
    letter-spacing: 0.02em;
  }

  /* — Section-level further reading — */
  .further-reading {
    margin-top: 2rem;
    padding-top: 1.2rem;
    border-top: 1px dashed var(--border);
  }

  .further-reading .fr-label {
    font-family: var(--mono);
    font-size: 0.62rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--fg-faint);
    margin-bottom: 0.6rem;
    font-weight: 500;
  }

  .further-reading ul {
    list-style: none;
    margin: 0;
  }

  .further-reading li {
    padding: 0.35rem 0;
    font-size: 0.84rem;
    line-height: 1.55;
    display: flex;
    gap: 0.5rem;
  }

  .further-reading li::before {
    content: '→';
    color: var(--fg-faint);
    flex-shrink: 0;
    font-family: var(--mono);
    font-size: 0.75rem;
    line-height: 1.75;
  }

  .further-reading .fr-type {
    font-family: var(--mono);
    font-size: 0.62rem;
    color: var(--fg-faint);
    background: var(--code-bg);
    border: 1px solid var(--code-border);
    border-radius: 3px;
    padding: 0.08em 0.35em;
    vertical-align: 1px;
    white-space: nowrap;
    margin-left: 0.3rem;
  }

  .further-reading .fr-note {
    color: var(--fg-muted);
    font-size: 0.8rem;
  }

  /* — Responsive — */
  @media (max-width: 600px) {
    html { font-size: 17px; }
    header { padding: 4rem 1.4rem 2rem; }
    header h1 { font-size: 2rem; }
    main { padding: 0 1.4rem 4rem; }
    nav.toc { padding: 2rem 1.4rem; }
    nav.toc ol { columns: 1; }
    pre { padding: 1rem; font-size: 0.72rem; }
    .diagram { padding: 1rem; font-size: 0.65rem; }
  }

  /* — Scroll-triggered fade — */
  .reveal {
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 0.5s ease, transform 0.5s ease;
  }

  .reveal.visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
</head>
<body>

<header>
  <div class="eyebrow">Technical Reference</div>
  <h1>React Internals</h1>
  <p class="subtitle">From JSX to pixels — Fiber architecture, reconciliation, hooks, concurrent rendering, and every layer between your code and the DOM.</p>
</header>

<nav class="toc">
  <div class="toc-label">Contents</div>
  <ol>
    <li><a href="#pipeline"><span class="num">01</span> The Pipeline</a></li>
    <li><a href="#fiber"><span class="num">02</span> Fiber Architecture</a></li>
    <li><a href="#render"><span class="num">03</span> Render Phase</a></li>
    <li><a href="#commit"><span class="num">04</span> Commit Phase</a></li>
    <li><a href="#hooks"><span class="num">05</span> How Hooks Work</a></li>
    <li><a href="#concurrent"><span class="num">06</span> Concurrent Features</a></li>
    <li><a href="#context"><span class="num">07</span> Context Internals</a></li>
    <li><a href="#events"><span class="num">08</span> Event System</a></li>
    <li><a href="#rsc"><span class="num">09</span> Server Components</a></li>
    <li><a href="#compiler"><span class="num">10</span> React Compiler</a></li>
    <li><a href="#misconceptions"><span class="num">11</span> Misconceptions</a></li>
    <li><a href="#source"><span class="num">12</span> Source Map</a></li>
    <li><a href="#resources"><span class="num">13</span> Resources</a></li>
  </ol>
</nav>

<main>

<!-- ═══════════════════════════════ 01 ═══════════════════════════════ -->
<section id="pipeline" class="reveal">
  <h2><span class="section-num">01</span> The Pipeline</h2>
  <p>When you write <code>&lt;App /&gt;</code>, a chain of transformations runs before pixels reach the screen. Understanding this full pipeline is the key to understanding React.</p>

  <div class="diagram"><span class="hl">JSX</span> → <span class="hl3">React.createElement()</span> → <span class="hl2">React Element</span> <span class="dim">(plain object)</span>
    → <span class="hl">Reconciler</span> <span class="dim">(Fiber)</span> → <span class="hl3">Commit</span> → <span class="hl2">DOM</span> → <span class="dim">Browser Paint</span></div>

  <p><strong>JSX is not HTML.</strong> Babel (or SWC/esbuild) transforms it into <code>React.createElement()</code> calls — or the newer <code>jsx()</code> runtime from React 17. The result is a plain JavaScript object:</p>

  <pre><code><span class="cm">// What you write:</span>
<span class="op">&lt;</span><span class="fn">div</span> <span class="prop">className</span><span class="op">=</span><span class="str">"app"</span><span class="op">&gt;</span>
  <span class="op">&lt;</span><span class="fn">Header</span> <span class="prop">title</span><span class="op">=</span><span class="str">"Hello"</span> <span class="op">/&gt;</span>
<span class="op">&lt;/</span><span class="fn">div</span><span class="op">&gt;</span>

<span class="cm">// What it becomes:</span>
{
  <span class="prop">$$typeof</span>: <span class="type">Symbol</span>(react.element),  <span class="cm">// Security: prevents JSON injection</span>
  <span class="prop">type</span>: <span class="str">'div'</span>,
  <span class="prop">props</span>: {
    <span class="prop">className</span>: <span class="str">'app'</span>,
    <span class="prop">children</span>: {
      <span class="prop">$$typeof</span>: <span class="type">Symbol</span>(react.element),
      <span class="prop">type</span>: Header,    <span class="cm">// Reference to the function</span>
      <span class="prop">props</span>: { <span class="prop">title</span>: <span class="str">'Hello'</span> },
    }
  },
}</code></pre>

  <div class="callout">
    <p>The <code>$$typeof: Symbol(react.element)</code> field is a security measure. Since Symbols can't be serialized to JSON, a server can't be tricked into returning a malicious element from user input.</p>
  </div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://overreacted.io/why-do-react-elements-have-typeof-property/" target="_blank">Why Do React Elements Have a $$typeof Property?</a> <span class="fr-type">article</span> <span class="fr-note">— Dan Abramov on the XSS protection mechanism</span></span></li>
      <li><span><a href="https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html" target="_blank">Introducing the New JSX Transform</a> <span class="fr-type">blog</span> <span class="fr-note">— React team on the jsx() runtime and why createElement was replaced</span></span></li>
      <li><span><a href="https://jser.dev/2023-01-28-how-does-jsx-work/" target="_blank">How Does JSX Work Internally?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev traces JSX from Babel to element objects to Fibers</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=CGpMlWVcHok" target="_blank">Building a Custom React Renderer</a> <span class="fr-type">video</span> <span class="fr-note">— Sophie Alpert shows how elements flow into the reconciler</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 02 ═══════════════════════════════ -->
<section id="fiber" class="reveal">
  <h2><span class="section-num">02</span> Fiber Architecture</h2>
  <p>Fiber is React's internal reconciliation engine, introduced in React 16 as a complete rewrite. It's the most important architectural concept in modern React.</p>

  <h3>Why Fiber Exists</h3>
  <p>The old Stack Reconciler processed the tree recursively and synchronously. Once it started, it couldn't stop — a large update could block the main thread for hundreds of milliseconds, causing jank. Fiber makes rendering <strong>interruptible</strong> by breaking work into small units that can be paused, resumed, or aborted.</p>

  <h3>What Is a Fiber?</h3>
  <p>A Fiber is a plain JavaScript object representing a unit of work. There's one for every component instance, DOM element, or React node in your tree — a mutable, linked-list-based work-in-progress tree.</p>

  <pre><code><span class="cm">// Simplified Fiber node</span>
{
  <span class="cm">// Identity</span>
  <span class="prop">tag</span>: FunctionComponent | HostComponent | ...,
  <span class="prop">type</span>: App,
  <span class="prop">key</span>: <span class="kw">null</span>,

  <span class="cm">// Tree structure (linked list, not array children)</span>
  <span class="prop">return</span>: parentFiber,
  <span class="prop">child</span>: firstChildFiber,
  <span class="prop">sibling</span>: nextSiblingFiber,

  <span class="cm">// State & Props</span>
  <span class="prop">memoizedState</span>: { <span class="prop">count</span>: <span class="num">0</span> },  <span class="cm">// Head of hooks linked list</span>
  <span class="prop">pendingProps</span>: { <span class="prop">title</span>: <span class="str">'World'</span> },

  <span class="cm">// Effects</span>
  <span class="prop">flags</span>: Update | Placement | Deletion,  <span class="cm">// Bitmask</span>
  <span class="prop">subtreeFlags</span>: Update,                  <span class="cm">// Bubbled from children</span>

  <span class="cm">// Scheduling</span>
  <span class="prop">lanes</span>: <span class="num">0b0000000000000000001</span>,  <span class="cm">// Priority bitmask</span>

  <span class="cm">// Double buffering</span>
  <span class="prop">alternate</span>: workInProgressFiber,
}</code></pre>

  <h3>Linked List Traversal</h3>
  <p>Unlike typical trees with arrays of children, Fiber uses <strong>child → sibling → return</strong> pointers. This lets React traverse iteratively with a while loop instead of recursively — which is what makes work interruptible. At any point, React knows exactly where it left off.</p>

  <div class="diagram">       <span class="hl">App</span>
        <span class="dim">│  (child)</span>
      <span class="hl2">Header</span> <span class="dim">──→</span> <span class="hl2">Content</span> <span class="dim">──→</span> <span class="hl2">Footer</span>  <span class="dim">(sibling links)</span>
        <span class="dim">│</span>          <span class="dim">│</span>
      <span class="hl3">Logo</span>      <span class="hl3">Article</span> <span class="dim">──→</span> <span class="hl3">Sidebar</span></div>

  <h3>Double Buffering</h3>
  <p>React maintains <strong>two</strong> Fiber trees at all times. The <strong>current</strong> tree reflects what's on screen. The <strong>workInProgress</strong> tree is where changes are applied. Each Fiber has an <code>alternate</code> pointer to its counterpart. On commit, React swaps — the WIP becomes current. This is double buffering, borrowed from graphics.</p>

  <div class="diagram"><span class="hl">current tree</span>:           <span class="hl2">workInProgress tree</span>:
  App <span class="dim">(count: 0)</span>  <span class="dim">←→</span>  App <span class="dim">(count: 1)</span>      <span class="dim">← alternate pointers</span>
   <span class="dim">│</span>                    <span class="dim">│</span>
  Div              →  Div
   <span class="dim">│</span>                    <span class="dim">│</span>
  Span <span class="str">"0"</span>         →  Span <span class="str">"1"</span>             <span class="dim">← Update flag</span></div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://github.com/acdlite/react-fiber-architecture" target="_blank">React Fiber Architecture</a> <span class="fr-type">gist</span> <span class="fr-note">— Andrew Clark's founding document; the original Fiber design</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=ZCuYPiUIONs" target="_blank">A Cartoon Intro to Fiber</a> <span class="fr-type">video</span> <span class="fr-note">— Lin Clark, React Conf 2017. Best visual overview of the architecture</span></span></li>
      <li><span><a href="https://indepth.dev/posts/1008/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react" target="_blank">Inside Fiber: In-Depth Overview</a> <span class="fr-type">deep dive</span> <span class="fr-note">— Max Koretskyi walks through every Fiber field with source references</span></span></li>
      <li><span><a href="https://jser.dev/2023-07-18-how-react-fiber-tree-is-constructed/" target="_blank">How the Fiber Tree Is Constructed</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev traces tree building step by step with interactive visualizer</span></span></li>
      <li><span><a href="https://pomb.us/build-your-own-react/" target="_blank">Build Your Own React (Didact)</a> <span class="fr-type">tutorial</span> <span class="fr-note">— Implement Fiber from scratch; best for hands-on understanding</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 03 ═══════════════════════════════ -->
<section id="render" class="reveal">
  <h2><span class="section-num">03</span> Render Phase</h2>
  <p>The render phase is where React figures out <em>what changed</em>. It's pure computation — no DOM mutations. This phase is interruptible in concurrent mode.</p>

  <h3>The Work Loop</h3>
  <pre><code><span class="kw">function</span> <span class="fn">workLoopConcurrent</span>() {
  <span class="kw">while</span> (workInProgress !== <span class="kw">null</span> && !<span class="fn">shouldYield</span>()) {
    <span class="fn">performUnitOfWork</span>(workInProgress);
  }
}

<span class="kw">function</span> <span class="fn">performUnitOfWork</span>(unitOfWork) {
  <span class="kw">const</span> next = <span class="fn">beginWork</span>(unitOfWork);  <span class="cm">// Process, return first child</span>
  <span class="kw">if</span> (next === <span class="kw">null</span>) {
    <span class="fn">completeUnitOfWork</span>(unitOfWork);    <span class="cm">// No children → sibling or parent</span>
  } <span class="kw">else</span> {
    workInProgress = next;
  }
}</code><span class="label">ReactFiberWorkLoop.js</span></pre>

  <p><code>shouldYield()</code> checks if the browser needs the main thread back (via <code>MessageChannel</code>). If so, React pauses and resumes later exactly where it left off.</p>

  <h3>beginWork</h3>
  <p>Called for each Fiber going <em>down</em> the tree. Behavior depends on the Fiber's tag: <strong>FunctionComponent</strong> → calls the function (runs hooks); <strong>ClassComponent</strong> → calls <code>render()</code>; <strong>HostComponent</strong> → diffs props; <strong>ContextProvider</strong> → pushes new value onto internal stack.</p>

  <h3>completeWork</h3>
  <p>Called going <em>back up</em>. Creates actual DOM nodes (but doesn't insert them), bubbles effect flags from children into <code>subtreeFlags</code>, and builds the effect list of Fibers needing DOM mutations.</p>

  <h3>The Diffing Algorithm</h3>
  <p>Instead of O(n³) general tree diff, React uses two heuristics for O(n):</p>
  <p><strong>Heuristic 1:</strong> Different types produce different trees — a <code>&lt;div&gt;</code> changing to <code>&lt;span&gt;</code> tears down the entire subtree.</p>
  <p><strong>Heuristic 2:</strong> Keys identify stable elements. For list children, React builds a Map keyed by <code>key</code> (or index), then walks the new list matching against it.</p>

  <div class="callout">
    <p><strong>Why index keys are bad:</strong> inserting at the beginning shifts every index, so React thinks every element changed — causing unnecessary unmounts and lost state.</p>
  </div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://jser.dev/2023-07-11-how-does-react-bindfiber/" target="_blank">How beginWork() Processes Each Fiber Type</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev annotated source walkthrough of the beginWork switch</span></span></li>
      <li><span><a href="https://legacy.reactjs.org/docs/reconciliation.html" target="_blank">Reconciliation — React Docs</a> <span class="fr-type">docs</span> <span class="fr-note">— Official explanation of the two heuristics and O(n) diffing</span></span></li>
      <li><span><a href="https://overreacted.io/react-as-a-ui-runtime/" target="_blank">React as a UI Runtime</a> <span class="fr-type">article</span> <span class="fr-note">— Dan Abramov covers host trees, reconciliation, and the rendering model</span></span></li>
      <li><span><a href="https://www.developerway.com/posts/reconciliation-and-keys" target="_blank">Reconciliation and Keys in Depth</a> <span class="fr-type">article</span> <span class="fr-note">— Nadia Makarevich on key behavior, index pitfalls, and reset patterns</span></span></li>
      <li><span><a href="https://jser.dev/2023-07-21-how-does-react-diff-list/" target="_blank">How React Diffs Lists Internally</a> <span class="fr-type">deep dive</span> <span class="fr-note">— Step-by-step trace of ReactChildFiber.js key matching algorithm</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 04 ═══════════════════════════════ -->
<section id="commit" class="reveal">
  <h2><span class="section-num">04</span> Commit Phase</h2>
  <p>The commit phase is <strong>synchronous</strong> — once started, it runs to completion. This prevents partially-updated UI. Three sub-phases:</p>

  <h3>1. Before Mutation</h3>
  <p>Calls <code>getSnapshotBeforeUpdate</code> for class components. Schedules passive effects (<code>useEffect</code>) but doesn't flush them yet.</p>

  <h3>2. Mutation</h3>
  <p>Actual DOM operations: insertions, updates, deletions. Runs <code>componentWillUnmount</code>, <code>useLayoutEffect</code> cleanups, and detaches refs from old nodes.</p>

  <h3>3. Layout</h3>
  <p>Runs <code>componentDidMount</code>/<code>componentDidUpdate</code>, fires <code>useLayoutEffect</code> callbacks synchronously (before paint), and attaches refs to new DOM nodes.</p>

  <p>After layout, React swaps <code>root.current</code> to the WIP tree. Then <em>asynchronously</em>, after the browser paints, it flushes passive effects.</p>

  <div class="diagram"><span class="hl">Render Phase</span> <span class="dim">(interruptible)</span>          <span class="hl2">Commit Phase</span> <span class="dim">(synchronous)</span>
┌─────────────────────────┐    ┌────────────────────────────────────┐
│ beginWork → completeWork│───→│ beforeMutation → mutation → layout │
│ <span class="dim">(builds WIP tree)</span>       │    │ <span class="dim">(applies changes to DOM)</span>           │
└─────────────────────────┘    └──────────────┬─────────────────────┘
                                              │
                                              ▼  <span class="dim">(async, after paint)</span>
                                     <span class="hl3">Passive Effects</span> (useEffect)</div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://jser.dev/2023-07-14-how-does-react-bindfiber-binds/" target="_blank">How the Commit Phase Works</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev traces mutation, layout, and passive effect phases in source</span></span></li>
      <li><span><a href="https://blog.isquaredsoftware.com/2020/05/blogged-answers-a-mostly-complete-guide-to-react-rendering-behavior/" target="_blank">A (Mostly) Complete Guide to React Rendering</a> <span class="fr-type">article</span> <span class="fr-note">— Mark Erikson covers the full render → commit pipeline and batching</span></span></li>
      <li><span><a href="https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberCommitWork.js" target="_blank">ReactFiberCommitWork.js</a> <span class="fr-type">source</span> <span class="fr-note">— The actual commit phase implementation in the React repo</span></span></li>
      <li><span><a href="https://overreacted.io/before-you-memo/" target="_blank">Before You memo()</a> <span class="fr-type">article</span> <span class="fr-note">— Dan Abramov on render vs. commit costs and when optimization matters</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 05 ═══════════════════════════════ -->
<section id="hooks" class="reveal">
  <h2><span class="section-num">05</span> How Hooks Work</h2>
  <p>Hooks are a linked list stored on <code>fiber.memoizedState</code>. No magic — just pointers.</p>

  <h3>The Linked List</h3>
  <p>Each hook call during render either creates a new node (mount) or advances to the next existing one (update). This is why hooks must be called in the same order every render — React uses call order, not names.</p>

  <div class="diagram"><span class="hl">fiber.memoizedState</span> → <span class="hl2">hook1</span> <span class="dim">(useState)</span>
                          <span class="dim">↓ next</span>
                        <span class="hl2">hook2</span> <span class="dim">(useEffect)</span>
                          <span class="dim">↓ next</span>
                        <span class="hl2">hook3</span> <span class="dim">(useMemo)</span>
                          <span class="dim">↓ next</span>
                        <span class="hl3">null</span></div>

  <h3>useState is useReducer</h3>
  <p><code>useState</code> is implemented as <code>useReducer</code> with a trivial reducer. When you call <code>setState</code>, React enqueues an update on the hook's circular queue, marks lanes on the Fiber, and schedules a re-render. All queued updates are processed together — this is batching.</p>

  <pre><code><span class="kw">function</span> <span class="fn">basicStateReducer</span>(state, action) {
  <span class="kw">return typeof</span> action === <span class="str">'function'</span> ? <span class="fn">action</span>(state) : action;
}

<span class="cm">// useState(initialValue) ≡ useReducer(basicStateReducer, initialValue)</span></code></pre>

  <h3>useEffect Execution</h3>
  <p>Effects are stored as a separate linked list on <code>fiber.updateQueue</code>. Dependency comparison uses <code>Object.is()</code> on each element — shallow, reference-based. <code>useEffect</code> runs asynchronously after paint. <code>useLayoutEffect</code> runs synchronously after DOM mutation, before paint.</p>

  <h3>useMemo / useCallback</h3>
  <p>Simpler than you'd expect. <code>useMemo</code> stores <code>[value, deps]</code> and recomputes only if deps change. <code>useCallback(fn, deps)</code> is literally <code>useMemo(() =&gt; fn, deps)</code>.</p>

  <h3>useRef</h3>
  <p>The simplest hook. Stores <code>{ current: initialValue }</code> on mount, returns the same object forever. Same identity = no re-renders on mutation.</p>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://www.youtube.com/watch?v=KJP1E-Y-xyo" target="_blank">Getting Closure on React Hooks</a> <span class="fr-type">video</span> <span class="fr-note">— swyx builds hooks from scratch in 29 minutes using closures</span></span></li>
      <li><span><a href="https://the-guild.dev/blog/react-hooks-system" target="_blank">Under the Hood of React Hooks</a> <span class="fr-type">article</span> <span class="fr-note">— Written companion to the swyx talk; walks the hooks linked list</span></span></li>
      <li><span><a href="https://overreacted.io/a-complete-guide-to-useeffect/" target="_blank">A Complete Guide to useEffect</a> <span class="fr-type">article</span> <span class="fr-note">— Dan Abramov on the mental model effects are built on</span></span></li>
      <li><span><a href="https://jser.dev/2023-06-19-how-does-usestate-work/" target="_blank">How Does useState Work Internally?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev traces useState through mount, update, and the dispatch queue</span></span></li>
      <li><span><a href="https://jser.dev/2023-06-26-how-does-useeffect-work/" target="_blank">How Does useEffect Work Internally?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev on effect creation, deps comparison, and flush timing</span></span></li>
      <li><span><a href="https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberHooks.js" target="_blank">ReactFiberHooks.js</a> <span class="fr-type">source</span> <span class="fr-note">— The complete hooks implementation. ~3000 lines, but well-structured</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 06 ═══════════════════════════════ -->
<section id="concurrent" class="reveal">
  <h2><span class="section-num">06</span> Concurrent Features</h2>
  <p>React 18+ can prepare multiple UI versions simultaneously and interrupt low-priority work for urgent updates.</p>

  <h3>The Lane Model</h3>
  <p>A 31-bit bitmask where each bit is a priority level. Lanes replaced expiration times because bitmasks let React group updates (OR bits together), process subsets per render, and skip irrelevant work with a bitwise AND.</p>

  <pre><code><span class="kw">const</span> SyncLane          = <span class="num">0b0000000000000000000000000000010</span>;  <span class="cm">// Discrete events</span>
<span class="kw">const</span> InputContinuousLane = <span class="num">0b0000000000000000000000000001000</span>;  <span class="cm">// Drag, scroll</span>
<span class="kw">const</span> DefaultLane       = <span class="num">0b0000000000000000000000000100000</span>;  <span class="cm">// Normal updates</span>
<span class="kw">const</span> TransitionLane1   = <span class="num">0b0000000000000000000001000000000</span>;  <span class="cm">// startTransition</span>
<span class="kw">const</span> IdleLane          = <span class="num">0b0100000000000000000000000000000</span>;  <span class="cm">// Lowest</span></code><span class="label">ReactFiberLane.js</span></pre>

  <h3>startTransition</h3>
  <p>Wrapping a state update in <code>startTransition</code> assigns it a Transition Lane. If a high-priority update arrives (like keyboard input), React interrupts the transition, handles the urgent update, and restarts later.</p>

  <h3>Time Slicing</h3>
  <p>React's scheduler divides work into ~5ms chunks and yields back to the browser between them via <code>MessageChannel</code> (not <code>requestIdleCallback</code>, which is too unpredictable). This keeps animations smooth and inputs responsive.</p>

  <h3>Suspense</h3>
  <p>When a component throws a Promise, React catches it, renders the nearest <code>&lt;Suspense&gt;</code> fallback, attaches a <code>.then()</code> to the Promise, and retries when it resolves. In concurrent mode, it can keep showing old UI during transitions instead of flashing spinners.</p>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://github.com/reactwg/react-18/discussions" target="_blank">React 18 Working Group Discussions</a> <span class="fr-type">forum</span> <span class="fr-note">— Core team explanations of automatic batching, Suspense, and transitions</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=FZ0cG47msEk" target="_blank">What is Concurrent React?</a> <span class="fr-type">video</span> <span class="fr-note">— Andrew Clark at React Conf 2021 on the concurrent model</span></span></li>
      <li><span><a href="https://jser.dev/2023-05-19-how-does-usetransition-work/" target="_blank">How Does useTransition Work?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev traces startTransition through lane assignment and interruption</span></span></li>
      <li><span><a href="https://jser.dev/2023-04-17-how-does-react-scheduler-work/" target="_blank">How Does the React Scheduler Work?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev on the priority queue, 5ms time slices, and MessageChannel</span></span></li>
      <li><span><a href="https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberLane.js" target="_blank">ReactFiberLane.js</a> <span class="fr-type">source</span> <span class="fr-note">— The full lane model: bitmask definitions, merging, subset checks</span></span></li>
      <li><span><a href="https://jser.dev/2023-04-23-how-does-suspense-work/" target="_blank">How Does Suspense Work Internally?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— Promise throwing, fallback rendering, ping mechanism, and retries</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 07 ═══════════════════════════════ -->
<section id="context" class="reveal">
  <h2><span class="section-num">07</span> Context Internals</h2>
  <p>When a Provider re-renders with a new value, React runs <code>propagateContextChange</code>: it walks the subtree, checks each Fiber's <code>dependencies</code> for this context, and marks matches with <code>ForceUpdate</code> — even through memoized ancestors.</p>

  <div class="callout">
    <p><strong>Context is all-or-nothing.</strong> Any change to the value re-renders <em>every</em> consumer, regardless of which slice they read. There's no built-in selector. This is what libraries like Zustand and Jotai solve.</p>
  </div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://jser.dev/2023-09-19-how-does-context-work/" target="_blank">How Does Context Work Internally?</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev on propagateContextChange, the dependency list, and forced updates</span></span></li>
      <li><span><a href="https://blog.isquaredsoftware.com/2021/01/context-redux-differences/" target="_blank">Context vs. Redux: Differences</a> <span class="fr-type">article</span> <span class="fr-note">— Mark Erikson on why Context isn't a state manager and when each is appropriate</span></span></li>
      <li><span><a href="https://github.com/dai-shi/use-context-selector" target="_blank">use-context-selector</a> <span class="fr-type">library</span> <span class="fr-note">— Daishi Kato's selector solution for Context; reveals the performance gap</span></span></li>
      <li><span><a href="https://www.developerway.com/posts/react-context-performance" target="_blank">React Context Performance Pitfalls</a> <span class="fr-type">article</span> <span class="fr-note">— Nadia Makarevich on splitting, memoizing, and composition patterns</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 08 ═══════════════════════════════ -->
<section id="events" class="reveal">
  <h2><span class="section-num">08</span> Event System</h2>
  <p>React doesn't attach listeners to individual DOM nodes. It uses <strong>event delegation</strong> — a single listener on the root container for each event type, registered during <code>createRoot()</code>.</p>
  <p>When a native event fires and bubbles to the root, React constructs a <strong>SyntheticEvent</strong>, walks the Fiber tree from target to root collecting handlers, and dispatches them in order (capture then bubble). Different events get different priorities: discrete events (click, keydown) → <code>SyncLane</code>, continuous events (mousemove, scroll) → <code>InputContinuousLane</code>.</p>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://jser.dev/2023-08-07-how-does-react-bindfiber-bindfiber/" target="_blank">How React's Event System Works</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev on delegation, SyntheticEvent pooling, and priority assignment</span></span></li>
      <li><span><a href="https://legacy.reactjs.org/blog/2020/08/10/react-v17-rc.html#changes-to-event-delegation" target="_blank">Changes to Event Delegation in React 17</a> <span class="fr-type">blog</span> <span class="fr-note">— React team explains moving delegation from document to root container</span></span></li>
      <li><span><a href="https://github.com/facebook/react/blob/main/packages/react-dom-bindings/src/events/ReactDOMEventListener.js" target="_blank">ReactDOMEventListener.js</a> <span class="fr-type">source</span> <span class="fr-note">— Where native events enter React's system; priority mapping lives here</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 09 ═══════════════════════════════ -->
<section id="rsc" class="reveal">
  <h2><span class="section-num">09</span> Server Components</h2>
  <p>React Server Components execute on the server and stream a serialized format to the client — not HTML, but the <strong>Flight protocol</strong>:</p>

  <pre><code><span class="num">0</span>:[<span class="str">"$"</span>,<span class="str">"div"</span>,<span class="kw">null</span>,{<span class="str">"children"</span>:[[<span class="str">"$"</span>,<span class="str">"h1"</span>,<span class="kw">null</span>,{<span class="str">"children"</span>:<span class="str">"Hello"</span>}]]}]
<span class="num">1</span>:<span class="type">I</span>[<span class="str">"./ClientComponent.js"</span>,<span class="str">"ClientComponent"</span>]</code><span class="label">Flight wire format</span></pre>

  <p><code>"$"</code> marks React elements. <code>"$L1"</code> means a lazy reference to a Client Component. Server Components are pre-rendered — their code never ships to the client. The <code>"use client"</code> directive creates the boundary; props crossing it must be serializable.</p>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://github.com/reactwg/server-components/discussions/5" target="_blank">RSC From Scratch</a> <span class="fr-type">tutorial</span> <span class="fr-note">— Dan Abramov builds RSC from zero. The definitive walkthrough</span></span></li>
      <li><span><a href="https://github.com/reactjs/rfcs/blob/main/text/0188-server-components.md" target="_blank">Server Components RFC</a> <span class="fr-type">rfc</span> <span class="fr-note">— The official proposal with motivation, semantics, and constraints</span></span></li>
      <li><span><a href="https://www.plasmic.app/blog/how-react-server-components-work" target="_blank">How React Server Components Work</a> <span class="fr-type">article</span> <span class="fr-note">— Plasmic's visual breakdown of the Flight wire format and streaming</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=TQQPAU21ZUw" target="_blank">React Server Components — React Conf 2024</a> <span class="fr-type">video</span> <span class="fr-note">— Core team on RSC architecture, streaming, and the "use server" directive</span></span></li>
      <li><span><a href="https://www.joshwcomeau.com/react/server-components/" target="_blank">Making Sense of RSC</a> <span class="fr-type">article</span> <span class="fr-note">— Josh Comeau's beginner-friendly explanation with great diagrams</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 10 ═══════════════════════════════ -->
<section id="compiler" class="reveal">
  <h2><span class="section-num">10</span> React Compiler</h2>
  <p>The React Compiler (originally "React Forget") is an AOT compiler that automatically memoizes components and hooks at build time. It tracks which variables depend on which reactive inputs and groups them into reactive scopes:</p>

  <pre><code><span class="cm">// What you write:</span>
<span class="kw">function</span> <span class="fn">TodoList</span>({ todos, filter }) {
  <span class="kw">const</span> filtered = todos.<span class="fn">filter</span>(<span class="fn">t</span> <span class="op">=></span> t.status === filter);
  <span class="kw">return</span> <span class="op">&lt;</span><span class="fn">List</span> <span class="prop">items</span>={filtered} <span class="op">/&gt;</span>;
}

<span class="cm">// What the compiler outputs (conceptually):</span>
<span class="kw">function</span> <span class="fn">TodoList</span>({ todos, filter }) {
  <span class="kw">const</span> $ = <span class="fn">useMemoCache</span>(<span class="num">4</span>);
  <span class="kw">if</span> ($[<span class="num">0</span>] !== todos || $[<span class="num">1</span>] !== filter) {
    $[<span class="num">2</span>] = todos.<span class="fn">filter</span>(<span class="fn">t</span> <span class="op">=></span> t.status === filter);
    $[<span class="num">0</span>] = todos;
    $[<span class="num">1</span>] = filter;
  }
  <span class="kw">return</span> $[<span class="num">2</span>];
}</code></pre>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://react.dev/learn/react-compiler" target="_blank">React Compiler — Official Docs</a> <span class="fr-type">docs</span> <span class="fr-note">— Setup guide, rules, and how the compiler understands your code</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=lyEKhv8-3n0" target="_blank">React Compiler Talk — React Conf 2024</a> <span class="fr-type">video</span> <span class="fr-note">— Core team on reactive scopes, analysis passes, and useMemoCache</span></span></li>
      <li><span><a href="https://playground.react.dev/" target="_blank">React Compiler Playground</a> <span class="fr-type">tool</span> <span class="fr-note">— Paste any component and see the compiled output in real time</span></span></li>
      <li><span><a href="https://www.developerway.com/posts/react-compiler-in-depth" target="_blank">React Compiler In Depth</a> <span class="fr-type">article</span> <span class="fr-note">— Nadia Makarevich on what the compiler can and cannot optimize</span></span></li>
      <li><span><a href="https://github.com/facebook/react/tree/main/compiler" target="_blank">React Compiler Source</a> <span class="fr-type">source</span> <span class="fr-note">— The compiler implementation in the React monorepo</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 11 ═══════════════════════════════ -->
<section id="misconceptions" class="reveal">
  <h2><span class="section-num">11</span> Misconceptions</h2>

  <div class="misconception">
    <div class="myth">"Virtual DOM diffing is fast."</div>
    <div class="reality">Not inherently. Diffing has cost. React's real win is batching DOM writes and avoiding layout-thrashing reads. Svelte and SolidJS skip the VDOM entirely and can outperform React for fine-grained updates.</div>
  </div>

  <div class="misconception">
    <div class="myth">"Re-renders mean DOM updates."</div>
    <div class="reality">A re-render means React <em>calls your component function</em> and diffs the output. If nothing changed, no DOM mutations happen. Re-renders are computation, not necessarily DOM work.</div>
  </div>

  <div class="misconception">
    <div class="myth">"useCallback prevents re-renders."</div>
    <div class="reality"><code>useCallback</code> stabilizes a function reference. It only prevents re-renders if the child is wrapped in <code>React.memo</code>. By itself, it does nothing.</div>
  </div>

  <div class="misconception">
    <div class="myth">"Context replaces state management."</div>
    <div class="reality">Context is dependency injection, not a state manager. No selector mechanism — every consumer re-renders on any change. For high-frequency updates, use Zustand, Jotai, or Redux.</div>
  </div>

  <div class="misconception">
    <div class="myth">"key is just for lists."</div>
    <div class="reality">You can use <code>key</code> on any component to force a full unmount/remount: <code>&lt;Profile key={userId} /&gt;</code>. Changing the key resets all state and effects.</div>
  </div>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://overreacted.io/before-you-memo/" target="_blank">Before You memo()</a> <span class="fr-type">article</span> <span class="fr-note">— Dan Abramov on when memoization is overkill and what to do instead</span></span></li>
      <li><span><a href="https://www.developerway.com/posts/react-re-renders-guide" target="_blank">React Re-Renders Guide</a> <span class="fr-type">article</span> <span class="fr-note">— Nadia Makarevich's comprehensive guide to what triggers re-renders and why</span></span></li>
      <li><span><a href="https://www.youtube.com/watch?v=7YhdqIR2Yzo" target="_blank">Virtual DOM Is Pure Overhead</a> <span class="fr-type">video</span> <span class="fr-note">— Rich Harris (Svelte) on why VDOM diffing is a means, not an end</span></span></li>
      <li><span><a href="https://tkdodo.eu/blog/why-you-want-react-query" target="_blank">Why You Want React Query</a> <span class="fr-type">article</span> <span class="fr-note">— TkDodo on why state management for server data is a solved problem</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 12 ═══════════════════════════════ -->
<section id="source" class="reveal">
  <h2><span class="section-num">12</span> Source Map</h2>
  <p>Key files in the React monorepo (<code>packages/react-reconciler/src/</code>):</p>

  <table class="file-table">
    <thead>
      <tr><th>File</th><th>What it does</th></tr>
    </thead>
    <tbody>
      <tr><td>ReactFiberWorkLoop.js</td><td>The render/commit loop — start here</td></tr>
      <tr><td>ReactFiberBeginWork.js</td><td>How each Fiber type is processed going down</td></tr>
      <tr><td>ReactFiberCompleteWork.js</td><td>How work is completed going up</td></tr>
      <tr><td>ReactFiberHooks.js</td><td>The entire hooks implementation</td></tr>
      <tr><td>ReactChildFiber.js</td><td>List diffing / key reconciliation</td></tr>
      <tr><td>ReactFiberLane.js</td><td>The lane priority model</td></tr>
      <tr><td>Scheduler.js</td><td>Userspace scheduler (independent of React)</td></tr>
    </tbody>
  </table>

  <div class="further-reading">
    <div class="fr-label">Further Reading</div>
    <ul>
      <li><span><a href="https://jser.dev/internals" target="_blank">React Internals Explorer</a> <span class="fr-type">tool</span> <span class="fr-note">— Interactive visualizer showing Fiber tree construction and hook state step by step</span></span></li>
      <li><span><a href="https://jser.dev/2023-07-11-overall-of-react-internals/" target="_blank">Overall of React Internals</a> <span class="fr-type">deep dive</span> <span class="fr-note">— jser.dev road map for navigating the React codebase</span></span></li>
      <li><span><a href="https://www.youtube.com/playlist?list=PLxRVWC-K96b0ktvhd16l9F9TFDhKpN5br" target="_blank">React Internals Deep Dive</a> <span class="fr-type">video series</span> <span class="fr-note">— Philip Fabianek walks through source code file by file</span></span></li>
    </ul>
  </div>
</section>

<!-- ═══════════════════════════════ 13 ═══════════════════════════════ -->
<section id="resources" class="reveal">
  <h2><span class="section-num">13</span> Resources</h2>

  <h3>Essential Reading</h3>
  <ul class="resources">
    <li>
      <div class="res-title"><a href="https://github.com/facebook/react" target="_blank">React Source Code</a></div>
      <div class="res-desc">Start with <code>ReactFiberWorkLoop.js</code>. The real thing.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://pomb.us/build-your-own-react/" target="_blank">Build Your Own React (Didact)</a></div>
      <div class="res-desc">Build a mini React from scratch — Fiber, hooks, concurrent mode. The single best learning exercise.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://github.com/acdlite/react-fiber-architecture" target="_blank">React Fiber Architecture</a></div>
      <div class="res-desc">Andrew Clark's founding document. The original design for Fiber.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://www.youtube.com/watch?v=ZCuYPiUIONs" target="_blank">A Cartoon Intro to Fiber — Lin Clark</a></div>
      <div class="res-desc">React Conf 2017. Best visual explanation of the work loop and interruptibility.</div>
    </li>
  </ul>

  <h3>Deep Dives by Topic</h3>
  <ul class="resources">
    <li>
      <div class="res-title"><a href="https://indepth.dev/posts/1008/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react" target="_blank">Inside Fiber — inDepthDev</a></div>
      <div class="res-desc">Detailed walkthrough of the Fiber algorithm with source code references.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://www.youtube.com/watch?v=KJP1E-Y-xyo" target="_blank">Getting Closure on Hooks — swyx</a></div>
      <div class="res-desc">JSConf talk. Builds hooks from scratch in 29 minutes using closures.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://overreacted.io/a-complete-guide-to-useeffect/" target="_blank">A Complete Guide to useEffect — Dan Abramov</a></div>
      <div class="res-desc">The mental model that effects are built on.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://github.com/reactwg/react-18/discussions" target="_blank">React 18 Working Group</a></div>
      <div class="res-desc">Core team explanations of batching, Suspense, transitions.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://github.com/reactwg/server-components/discussions/5" target="_blank">RSC From Scratch — Dan Abramov</a></div>
      <div class="res-desc">Building Server Components from zero. Flight protocol, streaming, boundaries.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://www.plasmic.app/blog/how-react-server-components-work" target="_blank">How RSCs Work — Plasmic</a></div>
      <div class="res-desc">Visual breakdown of the Flight wire format and rendering pipeline.</div>
    </li>
  </ul>

  <h3>Blogs & Series</h3>
  <ul class="resources">
    <li>
      <div class="res-title"><a href="https://overreacted.io/" target="_blank">overreacted.io — Dan Abramov</a></div>
      <div class="res-desc">Former core team. "Elements of UI Engineering", "Before You memo()".</div>
    </li>
    <li>
      <div class="res-title"><a href="https://jser.dev/" target="_blank">jser.dev</a></div>
      <div class="res-desc">Dedicated to React internals. Interactive Fiber visualizer, annotated source walkthroughs.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://blog.isquaredsoftware.com/" target="_blank">Mark Erikson's Blog</a></div>
      <div class="res-desc">Redux maintainer. Rendering behavior, Context performance, state management.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://www.developerway.com/" target="_blank">Developer Way — Nadia Makarevich</a></div>
      <div class="res-desc">Re-renders, composition, performance, and advanced patterns.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://www.youtube.com/playlist?list=PLxRVWC-K96b0ktvhd16l9F9TFDhKpN5br" target="_blank">React Internals Deep Dive — Philip Fabianek</a></div>
      <div class="res-desc">Multi-part YouTube series walking through React source code.</div>
    </li>
  </ul>

  <h3>Build Your Own</h3>
  <ul class="resources">
    <li>
      <div class="res-title"><a href="https://pomb.us/build-your-own-react/" target="_blank">Didact — Rodrigo Pombo</a></div>
      <div class="res-desc">Mini React with Fiber, reconciliation, hooks, and concurrent mode.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://jser.dev/2023-07-11-overall-of-react-internals/" target="_blank">Build Your Own React in 400 Lines — jser.dev</a></div>
      <div class="res-desc">More faithful to actual React internals than Didact.</div>
    </li>
    <li>
      <div class="res-title"><a href="https://playground.react.dev/" target="_blank">React Compiler Playground</a></div>
      <div class="res-desc">See exactly what the compiler outputs for any input.</div>
    </li>
  </ul>
</section>

</main>

<footer>
  React Internals Reference — Based on React 18/19 source code
</footer>

<script>
  // Scroll-triggered reveal
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.08, rootMargin: '0px 0px -40px 0px' });

  document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
</body>
</html>
